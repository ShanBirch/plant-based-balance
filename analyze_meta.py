import csv
from datetime import datetime
import io

# Meta Invoice Data provided by user
meta_csv_data = """Date,Transaction ID,Payment method,Amount,Currency
10/01/2026,25498357123182454-25445348055150026,Visa ... 6473,12.35,AUD
09/01/2026,25553143617703805-25413063845045115,Visa ... 6473,89.94,AUD
09/01/2026,25404541442564027-25489559724062197,Visa ... 3746,76.85,AUD
08/01/2026,25417392177945611-25480566688294831,Visa ... 3746,0.66,AUD
08/01/2026,25425001790517986-25486024041082426,Visa ... 3746,76.38,AUD
02/01/2026,25351042111247289-25490900947261406,Visa ... 3746,3.64,AUD
02/01/2026,25355565797461584-25366132529738243,Visa ... 3746,0.19,AUD
02/01/2026,25358053720546124-25375939582090874,Visa ... 3746,75.42,AUD
01/01/2026,25474765645541603-25425740993777398,Visa ... 3746,75.08,AUD
18/12/2025,25246422125042618-25309668015384700,Visa ... 3746,142.93,AUD
17/12/2025,25362291880122314-25237836992567798,Visa ... 6473,75.32,AUD
16/12/2025,25237919115892922-25213323381685830,Visa ... 3746,0.26,AUD
16/12/2025,25215525244798974-25561715900179911,Visa ... 3746,75.00,AUD
16/12/2025,25205885835762923-25288796300805205,Visa ... 3746,5.99,AUD
15/12/2025,25182541838097318-25224247463926754,Visa ... 3746,107.38,AUD
13/12/2025,25177792761905564-25187536194264546,Visa ... 3746,13.86,AUD
13/12/2025,25512934835058018-25321790957505740,Visa ... 3746,99.43,AUD
11/12/2025,25172997355718430-25307228112295358,Visa ... 3746,26.02,AUD
11/12/2025,25179505101734321-25246241105060728,Visa ... 3746,0.23,AUD
11/12/2025,25158273977190768-25179504801734351,Visa ... 3746,76.15,AUD
09/12/2025,25167810396237125-25231356743215828,Visa ... 3746,107.38,AUD
08/12/2025,25224676780550494-25138371375847703,Visa ... 3746,75.02,AUD
07/12/2025,25218238551194311-25483597971325038,Visa ... 3746,18.80,AUD
07/12/2025,25199883133029859-25150238141327684,Visa ... 3746,75.00,AUD
02/12/2025,25085950601089781-25105597415791757,Visa ... 3746,33.54,AUD
30/11/2025,25156393057378867-25156393100712196,Visa ... 3746,1.55,AUD
30/11/2025,25157408997277267-25069750926043082,Visa ... 3746,2.17,AUD
30/11/2025,25074874492197387-25157257410625759,Visa ... 3746,28.53,AUD
27/11/2025,25192245573793613-25134827099535463,Visa ... 3746,0.19,AUD
27/11/2025,25045005035184338-25401297982888371,Visa ... 3746,79.18,AUD
26/11/2025,25045036695181167-25183466854671485,Visa ... 3746,22.34,AUD
26/11/2025,25109605935390913-25045036428514527,Visa ... 3746,100.63,AUD
25/11/2025,25170697545948416-25114677771550390,Visa ... 3746,25.71,AUD
24/11/2025,25033491946335639-25109604198724420,Visa ... 3746,0.44,AUD
24/11/2025,25371824445835725-25033491759668991,Visa ... 3746,85.37,AUD
23/11/2025,25100882182929955-25097535419931295,Visa ... 3746,73.50,AUD
22/11/2025,25035409409477228-25093570376994469,Visa ... 3746,75.06,AUD
21/11/2025,25082934341391406-25349196418098528,Visa ... 3746,76.43,AUD
20/11/2025,24996925896658911-25074056575612510,Visa ... 3746,75.05,AUD
19/11/2025,24988002257551275-25065029696515198,Visa ... 3746,123.19,AUD
18/11/2025,24971338059217698-25048694131482091,Visa ... 3746,75.34,AUD
17/11/2025,25102269759457862-25046544901697011,Visa ... 3746,0.26,AUD
17/11/2025,24966621653022669-25046544218363746,Visa ... 3746,87.54,AUD
16/11/2025,24966021986415968-25032668666417974,Visa ... 3746,63.50,AUD
15/11/2025,25019976577687180-24965349083149928,Visa ... 3746,75.08,AUD
14/11/2025,25015635998121235-25014546174896890,Visa ... 3746,82.03,AUD
13/11/2025,25269904629361041-24937102809307886,Visa ... 3746,75.25,AUD
12/11/2025,24908954328789410-24928661353485365,Visa ... 3746,0.19,AUD
12/11/2025,24989577050727130-24914407024910802,Visa ... 3746,84.07,AUD
10/11/2025,24893757320309111-24913388315012669,Visa ... 3746,36.59,AUD
10/11/2025,24896616056689899-25034296989588473,Visa ... 3746,127.02,AUD
08/11/2025,25226566690361502-24961461690205333,Visa ... 3746,27.19,AUD
08/11/2025,24936180502733455-24960726450278863,Visa ... 3746,123.51,AUD
06/11/2025,24859414223743416-24853611207657056,Visa ... 3746,16.33,AUD
06/11/2025,24853610414323802-24940192475665594,Visa ... 3746,65.32,AUD
06/11/2025,24864663183218517-24881259658225538,Visa ... 3746,32.66,AUD
06/11/2025,24873362039015297-24940191008999074,Visa ... 3746,16.33,AUD
04/11/2025,24853304884354346-24844739728544196,Visa ... 3746,69.81,AUD
04/11/2025,24962576233427216-24833377596347084,Visa ... 3746,80.19,AUD
03/11/2025,24891561687195334-24902335306117975,Visa ... 3746,111.78,AUD
01/11/2025,24947161708302002-24824196020598566,Visa ... 3746,64.56,AUD
31/10/2025,24877570828594423-24937833685901471,Visa ... 3746,81.35,AUD
30/10/2025,24871730485845127-24784747467876764,Visa ... 3746,33.86,AUD
30/10/2025,24849996721351834-24867634579588048,Visa ... 3746,75.85,AUD
28/10/2025,24854811087537061-24767334192951425,Visa ... 3746,77.27,AUD
27/10/2025,24901244409560399-24840780255606814,Visa ... 3746,91.47,AUD
26/10/2025,24834713336213509-24835490749469095,Visa ... 3746,28.41,AUD
26/10/2025,24745394928478685-24745394971812014,Visa ... 3746,118.38,AUD
24/10/2025,24739104615774375-24754433327574839,Visa ... 3746,57.97,AUD
23/10/2025,24722991270719046-24798600196491487,Visa ... 3746,75.08,AUD
22/10/2025,24704408979243947-24787200947631412,Visa ... 3746,147.41,AUD
20/10/2025,24684417827909729-24712131765138329,Visa ... 3746,22.93,AUD
20/10/2025,24671757165842462-25037600735924766,Visa ... 3746,54.40,AUD
19/10/2025,24671755939175918-24671755975842581,Visa ... 3746,8.87,AUD
19/10/2025,24792048723813302-24671755749175937,Visa ... 3746,48.97,AUD
17/10/2025,24662520140099490-24670709465947223,Visa ... 3746,24.78,AUD
16/10/2025,24725862433765261-24723813510636826,Visa ... 3746,35.01,AUD
15/10/2025,24770161689335339-24655554440796062,Visa ... 3746,23.70,AUD
15/10/2025,24690964420588399-24770161436002031,Visa ... 3746,32.03,AUD
14/10/2025,24644337808584392-24970576755960498,Visa ... 3746,30.65,AUD
13/10/2025,24750914151260093-24690980037253504,Visa ... 3746,2.03,AUD
13/10/2025,24629646950053475-24693494573668720,Visa ... 3746,39.42,AUD
12/10/2025,24686086877742817-24625736687111171,Visa ... 3746,30.10,AUD
11/10/2025,24674121168939388-24674121218939383,Visa ... 3746,26.90,AUD
10/10/2025,24574472435570936-24597613919923445,Visa ... 3746,30.09,AUD
09/10/2025,24649169574767887-24649169644767880,Visa ... 3746,23.86,AUD
08/10/2025,2457889536128637-24639303412421164,Visa ... 3746,30.01,AUD
07/10/2025,24564887296529441-24541418078876372,Visa ... 3746,41.87,AUD
06/10/2025,24618567924494713-24529203823431131,Visa ... 3746,30.03,AUD
05/10/2025,24545073845177453-24610544051963767,Visa ... 3746,29.25,AUD
04/10/2025,24521296604221848-24521296697555172,Visa ... 3746,30.03,AUD
03/10/2025,24583740184644157-24855547474130094,Visa ... 3746,12.44,AUD
03/10/2025,24496847886666725-24586065561078283,Visa ... 3746,12.40,AUD
02/10/2025,24572787132406129-24518139724537535,Visa ... 3746,30.05,AUD
01/10/2025,24619583334393176-24500909016260603,Visa ... 3746,34.65,AUD
30/09/2025,24477149858636523-24550258041325708,Visa ... 3746,30.04,AUD
29/09/2025,24481887148162790-24473709758980530,Visa ... 3746,28.15,AUD
28/09/2025,24479143018437206-24532967899721386,Visa ... 3746,30.00,AUD
27/09/2025,24452488694435973-24456210424063797,Visa ... 3746,12.42,AUD
27/09/2025,24504396082578568-24583283781356465,Visa ... 3746,41.33,AUD
25/09/2025,24777206745297501-24510486011969572,Visa ... 3746,44.11,AUD
23/09/2025,24546554415029402-24432798193071689,Visa ... 3746,56.86,AUD
22/09/2025,24406201465731363-24749494871402022,Visa ... 3746,50.22,AUD
21/09/2025,24463989139952596-24475462125471961,Visa ... 3746,139.00,AUD
17/09/2025,24707333678951475-24494500790234765,Visa ... 3746,58.92,AUD
15/09/2025,24403994775952033-24418338861184294,Visa ... 3746,128.00,AUD
13/09/2025,24464516233233221-24351284967889679,Visa ... 3746,2.13,AUD
13/09/2025,24391800560504791-24677489701935873,Visa ... 3746,115.87,AUD
12/09/2025,24338097699208403-24338097725875067,Visa ... 3746,75.29,AUD
12/09/2025,24334324409585732-24398288053189369,Visa ... 3746,0.03,AUD
12/09/2025,24385832434434934-24326114010406773,Visa ... 3746,75.00,AUD
10/09/2025,24649790021372508-24318935111124662,Visa ... 3746,113.58,AUD
08/09/2025,24358385490512965-24365427103142131,Visa ... 3746,88.96,AUD
07/09/2025,24297104863307690-24284566227894885,Visa ... 3746,75.49,AUD
06/09/2025,24332548829763292-24615788938105950,Visa ... 3746,109.00,AUD
04/09/2025,24262307010120809-24273228059028704,Visa ... 3746,100.00,AUD
03/09/2025,24321724190845756-24313978548286993,Visa ... 3746,57.17,AUD
03/09/2025,24254689394215901-24585291644489013,Visa ... 3746,85.36,AUD
01/09/2025,24242407448777429-24245970428421134,Visa ... 3746,0.21,AUD
01/09/2025,24230565009961674-24234086859609489,Visa ... 3746,50.04,AUD
30/08/2025,24551267941224717-24336947479323431,Visa ... 3746,60.56,AUD
28/08/2025,24192118030473042-24203701749314666,Visa ... 3746,14.49,AUD
28/08/2025,24240374878980691-24178364471848403,Visa ... 3746,69.38,AUD
26/08/2025,24180157771669068-24254299570921552,Visa ... 3746,31.11,AUD
26/08/2025,24240373755647470-24516115241406654,Visa ... 3746,41.94,AUD
24/08/2025,24231152483236264-24165017386516440,Visa ... 3746,30.19,AUD
24/08/2025,24499734593044719-24143695505315300,Visa ... 3746,20.94,AUD
23/08/2025,24495759936775518-24168259556192222,Visa ... 3746,30.00,AUD
22/08/2025,24154256587592519-24140063899011789,Visa ... 3746,25.97,AUD
21/08/2025,24207956555555854-24145881388430036,Visa ... 3746,30.00,AUD
20/08/2025,24133359609682214-24185531281131721,Visa ... 3746,11.90,AUD
20/08/2025,24177767991908044-24195367873481389,Visa ... 3746,30.01,AUD
18/08/2025,24124600520558126-24174000652284784,Visa ... 3746,29.82,AUD
17/08/2025,24230551153296398-24169318749419638,Visa ... 3746,21.93,AUD
17/08/2025,24112202291797946-24163850749966441,Visa ... 3746,30.02,AUD
15/08/2025,24090478657303644-24213405678344279,Visa ... 3746,25.60,AUD
14/08/2025,24143139495370897-24140967195588130,Visa ... 3746,30.07,AUD
13/08/2025,24143298125355031-24196134773404703,Visa ... 3746,38.24,AUD
12/08/2025,24071546275863548-24124974173854096,Visa ... 3746,29.89,AUD
11/08/2025,24394013226950190-24055924914092352,Visa ... 3746,0.01,AUD
11/08/2025,24030578429960342-24063825206635655,Visa ... 3746,36.56,AUD
10/08/2025,24025826693768849-24105946099090237,Visa ... 3746,21.95,AUD
10/08/2025,24149183684766479-24103096572708526,Visa ... 3746,47.19,AUD
09/08/2025,24094672483550935-24032551273096386,Visa ... 3746,30.23,AUD
08/08/2025,24034974419520734-24088009954217185,Visa ... 3746,32.49,AUD
07/08/2025,24079594898392024-24079594915058689,Visa ... 3746,50.17,AUD
06/08/2025,24016482708036572-24346411501710363,Visa ... 3746,61.43,AUD
05/08/2025,24055179257500258-24055179260833591,Visa ... 3746,50.01,AUD
04/08/2025,23990752847276226-24051392937878887,Visa ... 3746,28.10,AUD
04/08/2025,23997921579892688-24326138123737701,Visa ... 3746,38.98,AUD
03/08/2025,24040025129015668-24040025132349001,Visa ... 3746,11.34,AUD
02/08/2025,23968783809473133-23954411000910419,Visa ... 3746,18.03,AUD
02/08/2025,24076963838655131-24043843891967122,Visa ... 3746,53.66,AUD
01/08/2025,23942355395449313-23970585872626256,Visa ... 3746,50.10,AUD
31/07/2025,24014335551584629-24017832324568282,Visa ... 3746,0.19,AUD
31/07/2025,23954786440872869-23951460361205478,Visa ... 3746,30.21,AUD
29/07/2025,24280723234945857-24003358096015705,Visa ... 3746,29.61,AUD
29/07/2025,23920029354348579-23952309967787183,Visa ... 3746,40.36,AUD
28/07/2025,23923970473954467-23909083032109883,Visa ... 3746,10.34,AUD
27/07/2025,23986381241046724-23995675476783964,Visa ... 3746,0.24,AUD
27/07/2025,23991942767157235-23920027767682071,Visa ... 3746,30.00,AUD
26/07/2025,23893084907043029-24033075856377263,Visa ... 3746,12.13,AUD
24/07/2025,23901433982874780-24238642439153937,Visa ... 3746,18.75,AUD
24/07/2025,23906298962388281-23968065849544927,Visa ... 3746,87.61,AUD
22/07/2025,24219446407740207-23875611492123699,Visa ... 3746,81.47,AUD
21/07/2025,24210907565260758-23991449860539863,Visa ... 3746,100.00,AUD
20/07/2025,23873352545682926-23982191978132318,Visa ... 3746,100.00,AUD
17/07/2025,10091108514333896-24181854614832720,Visa ... 3746,0.11,AUD
17/07/2025,10082640268514052-10091107177667363,Visa ... 3746,100.24,AUD
"""

def parse_and_analyze():
    # Use io.StringIO to treat the string like a file
    f = io.StringIO(meta_csv_data.strip())
    reader = csv.reader(f)
    
    # 1. FY2025: July 1, 2024  to June 30, 2025
    # Note: Invoice dates are dd/mm/yyyy.
    # Note: Invoice year 2025/2026 data is present.
    # We need to map dates correctly.
    
    fy_start = datetime(2024, 7, 1)
    fy_end = datetime(2025, 6, 30)
    
    q3_start = datetime(2025, 10, 1)
    q3_end = datetime(2025, 12, 31)
    
    total_fy = 0.0
    total_q3 = 0.0
    
    print("--- PARSING META ADS DATA ---")
    
    dates_found = []

    # Skip header
    try:
        header = next(reader)
    except StopIteration:
        return

    for row in reader:
        if len(row) < 4: continue
        
        date_str = row[0]
        amount_str = row[3]
        
        try:
            dt = datetime.strptime(date_str, "%d/%m/%Y")
            dates_found.append(dt)
            amt = float(amount_str)
            
            # Check FY2025 (July 1 2024 - June 30 2025)
            if fy_start <= dt <= fy_end:
                total_fy += amt
                
            # Check Q3 2025 (Oct-Dec)
            if q3_start <= dt <= q3_end:
                total_q3 += amt
                
        except ValueError:
            continue
            
    if dates_found:
        print(f"Data Range Found: {min(dates_found).date()} to {max(dates_found).date()}")
    
    print(f"Total Meta Ads Spend (FY 2024-2025): ${total_fy:.2f}")
    print(f"Total Meta Ads Spend (Oct-Dec 2025): ${total_q3:.2f}")

if __name__ == "__main__":
    parse_and_analyze()
